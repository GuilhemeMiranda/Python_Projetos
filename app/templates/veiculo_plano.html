{% extends "base.html" %}
{% block title %}Associar Planos aos Ve√≠culos{% endblock %}

{% block content %}
<main class="card report-card" aria-label="Associa√ß√£o de Planos">
  <header class="card-header">
    <h1>üîó Associar Planos aos Ve√≠culos</h1>
  </header>

  <!-- Formul√°rio de Associa√ß√£o -->
  <section class="form-vertical">
    <div class="form-row">
      <label for="veiculo_id" class="label">Selecione o Ve√≠culo:</label>
      <select id="veiculo_id" class="input" required>
        <option value="">Carregando ve√≠culos...</option>
      </select>
    </div>

    <div class="form-row">
      <label for="plano_id" class="label">Selecione o Plano:</label>
      <select id="plano_id" class="input" required>
        <option value="">Carregando planos...</option>
      </select>
    </div>

    <div class="form-row">
      <label for="proxima_data" class="label">Pr√≥xima Data (opcional):</label>
      <input id="proxima_data" type="date" class="input small" />
      <small class="muted">Data prevista para a pr√≥xima manuten√ß√£o</small>
    </div>

    <div class="form-row">
      <label for="proximo_km" class="label">Pr√≥ximo KM (opcional):</label>
      <input id="proximo_km" type="number" class="input small" min="0" placeholder="Ex: 15000" />
      <small class="muted">KM previsto para a pr√≥xima manuten√ß√£o</small>
    </div>

    <div class="actions">
      <button id="btnAssociar" class="btn btn-primary">‚ûï Associar Plano</button>
    </div>

    <div id="formMsg" class="muted"></div>
  </section>

  <!-- Lista de Associa√ß√µes -->
  <section class="table-wrap">
    <h2 style="color: var(--muted); margin-bottom: 12px;">Planos Associados</h2>
    <table id="associacoesTable" class="table">
      <thead>
        <tr>
          <th>Ve√≠culo</th>
          <th>Plano</th>
          <th>Pr√≥xima Data</th>
          <th>Pr√≥ximo KM</th>
          <th>A√ß√µes</th>
        </tr>
      </thead>
      <tbody>
        <tr>
          <td colspan="5" class="text-center">Carregando...</td>
        </tr>
      </tbody>
    </table>
    <div id="listMsg" class="muted"></div>
  </section>
</main>

<!-- Modal de Confirma√ß√£o de Exclus√£o -->
<div id="deleteModal" class="modal" style="display:none;">
  <div class="modal-content modal-small">
    <div class="modal-header">
      <h2>Confirmar Remo√ß√£o</h2>
      <button id="closeDeleteModal" class="close-btn">&times;</button>
    </div>
    <div class="modal-body" style="padding: 24px;">
      <p>Tem certeza que deseja remover esta associa√ß√£o?</p>
      <p class="muted" style="color: #dc3545; font-weight: 600;">Esta a√ß√£o n√£o pode ser desfeita!</p>
      
      <div class="actions" style="margin-top: 24px;">
        <button type="button" id="btnCancelarDelete" class="btn btn-light">Cancelar</button>
        <button type="button" id="btnConfirmarDelete" class="btn btn-danger">Remover</button>
      </div>

      <div id="deleteMsg" class="muted" style="margin-top: 16px;"></div>
    </div>
  </div>
</div>

<script src="/static/veiculo_plano.js" defer></script>
{% endblock %}